<script type="text/javaScript">
Qualtrics.SurveyEngine.addOnload(function()
{
	/*Place your JavaScript here to run when the page loads*/
	var answer = "${q://QID8/ChoiceGroup/SelectedChoices}";
	var txt1 = '[{"Switches":[{"switch":"off-on"},{"level":"setLevel"},{"energy":""}]},{"LED strip":[{"indicatorStatus":"indicatorNever-indicatorWhenOff-indicatorWhenOn"},{"switch":"off-on"}]},{"Light Bulb":[{"switch":"off-on"},{"level":"setLevel"},{"colorValue":"setColorValue"},{"color-hue-saturation":"setColor-setHue-setSaturation"},{"colorValue":"setColorValue"},{"colorMode":""}]},{"Lock":[{"lock":"lock-unlock"},{"":"configure"}]},{"Alarm":[{"alarm":"both-off-siren-strobe"}]},{"Camera":[{"switch":"off-on"},{"image":"take"}]},{"Doorbell":[{"door":"close-open"},{"alarm":"both-off-siren-strobe"}]},{"Garage Door":[{"door":"close-open"},{"door":"close-open"},{"threeAxis":""},{"contact":""},{"lqi-rssi":""},{"temperature":""}]},{"Sprinkler":[{"switch":"off-on"},{"":"push"}]},{"Button":[{"button-numberOfButtons":""}]},{"Robot Vacuum":[{"switch":"off-on"},{"robotCleanerCleaningMode":"setRobotCleanerCleaningMode"},{"robotCleanerMovement":"setRobotCleanerMovement"},{"robotCleanerTurboMode":"setRobotCleanerTurboMode"}]},{"Thermostat":[{"temperature":""},{"coolingSetpoint-coolingSetpointRange-heatingSetpoint-heatingSetpointRange-schedule-supportedThermostatFanModes-supportedThermostatModes-temperature-thermostatFanMode-thermostatMode-thermostatOperatingState-thermostatSetpoint-thermostatSetpointRange":"auto-cool-emergencyHeat-fanAuto-fanCirculate-fanOn-heat-off-setCoolingSetpoint-setHeatingSetpoint-setSchedule-setThermostatFanMode-setThermostatMode"},{"coolingSetpoint":"setCoolingSetpoint"},{"thermostatSetpoint":""},{"supportedThermostatFanModes-thermostatFanMode":"fanAuto-fanCirculate-fanOn-setThermostatFanMode"},{"heatingSetpoint":"setHeatingSetpoint"},{"supportedThermostatModes-thermostatMode":"auto-cool-emergencyHeat-heat-off-setThermostatMode"},{"thermostatOperatingState":""},{"humidity":""}]},{"Water Heater":[{"switch":"off-on"},{"water":""}]},{"Air Conditioner":[{"airConditionerMode":"setAirConditionerMode"},{"switch":"off-on"},{"temperature":""},{"level":"setLevel"},{"rapidCooling":"setRapidCooling"}]},{"TV":[{"switch":"off-on"},{"tvChannel":"channelDown-channelUp-setTvChannel"},{"inputSource-supportedInputSources":"setInputSource"},{"activities-currentActivity":"startActivity"}]},{"Dryer":[{"completionTime-dryerJobState-machineState-supportedMachineStates":"setMachineState"},{"dryerMode":"setDryerMode"}]},{"Humidity Sensor":[{"humidity":""},{"temperature":""}]},{"Moisture Sensor":[{"water":""},{"temperature":""}]},{"Motion":[{"motion":""}]},{"CO detector":[{"carbonMonoxide":""},{"alarm":"both-off-siren-strobe"},{"tamper":""},{"battery":""}]},{"Tilt Sensor":[{"threeAxis":""},{"motion":""},{"acceleration":""},{"lqi-rssi":""}]},{"Open/Close Sensor":[{"contact":""}]},{"Smoke Detector":[{"smoke":""},{"temperature":""},{"tamper":""},{"battery":""}]},{"Presence Sensor":[{"presence":""},{"":"beep"},{"lqi-rssi":""}]},{"Temperature Sensor":[{"temperature":""},{"humidity":""}]},{"Speaker":[{"switch":"off-on"},{"mute":"mute-setMute-unmute"},{"":"playTrack-playTrackAndRestore-playTrackAndResume"},{"audioTrackData":""},{"volume":"setVolume-volumeDown-volumeUp"},{"level-mute-status-trackData-trackDescription":"mute-nextTrack-pause-play-playTrack-previousTrack-restoreTrack-resumeTrack-setLevel-setTrack-stop-unmute"}]},{"Energy Meter":[{"energy":""},{"power":""},{"":""},{"":"configure"},{"powerSource":""}]},{"Coffee Maker":[{"switch":"off-on"},{"temperature":""}]},{"Shades and Blinds":[{"windowShade":"close-open-presetPosition"}]},{"Valve":[{"valve":"close-open"}]},{"Vent":[{"thermostatOperatingState":""},{"temperature":""}]},{"Beacon Device":[{"presence":""}]},{"Air Purifier":[{"airQuality":""},{"switch":"off-on"}]},{"Water Leak Detector":[{"water":""},{"alarm":"both-off-siren-strobe"}]},{"Induction CookTop":[{"switch":"off-on"},{"temperature":""}]},{"Dishwasher":[{"dishwasherMode":"setDishwasherMode"},{"completionTime-dishwasherJobState-machineState-supportedMachineStates":"setMachineState"}]},{"Refrigerator":[{"refrigerationSetpoint":"setRefrigerationSetpoint"},{"switch":"off-on"}]},{"Microwave Oven":[{"completionTime-machineState-operationTime-ovenJobState-progress-supportedMachineStates":"setMachineState-stop"},{"switch":"off-on"},{"ovenMode":"setOvenMode"}]},{"Smoke Detector":[{"smoke":""},{"battery":""}]},{"Glass Break Detector":[{"shock":""}]},{"Fan":[{"fanSpeed":"setFanSpeed"},{"switch":"off-on"}]},{"Pulse Monitor":[{"":""}]},{"Sleep Monitor":[{"sleeping":""}]},{"Smart Battery":[{"battery":""},{"powerSource":""}]},{"Smart Printer":[{"switch":"off-on"}]},{"Weather Station":[{"coolingSetpoint-coolingSetpointRange-heatingSetpoint-heatingSetpointRange-schedule-supportedThermostatFanModes-supportedThermostatModes-temperature-thermostatFanMode-thermostatMode-thermostatOperatingState-thermostatSetpoint-thermostatSetpointRange":"auto-cool-emergencyHeat-fanAuto-fanCirculate-fanOn-heat-off-setCoolingSetpoint-setHeatingSetpoint-setSchedule-setThermostatFanMode-setThermostatMode"},{"illuminance":""},{"temperature":""},{"humidity":""},{"ultravioletIndex":""},{"":""}]},{"Water purifier":[{"water":""}]},{"Gas Sensor":[{"odorLevel":""},{"alarm":"both-off-siren-strobe"}]},{"Smart Mirror":[{"image":"take"},{"videoClip":"captureClip"}]},{"Dust Detector":[{"dustLevel-fineDustLevel":""}]},{"Blood Pressure Monitor":[{"":""}]},{"Blood Oximeter":[{"":""}]},{"Oil Heater":[{"switch":"off-on"},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Electric Blanket":[{"switch":"off-on"},{"temperature":""}]},{"Dehumidifier":[{"humidity":""},{"temperature":""},{"switch":"off-on"}]},{"Humidifier":[{"humidity":""},{"temperature":""},{"switch":"off-on"}]},{"Kettle":[{"switch":"off-on"},{"temperature":""},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Rice Cooker":[{"switch":"off-on"},{"temperature":""},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"SoyMilk Maker":[{"switch":"off-on"},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Bread Maker":[{"switch":"off-on"},{"temperature":""},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Gas Stove":[{"switch":"off-on"},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Air Cooler":[{"switch":"off-on"},{"fanSpeed":"setFanSpeed"}]},{"Milk Dispenser":[{"switch":"off-on"},{"completionTime-sessionStatus":"cancel-pause-setCompletionTime-start-stop"}]},{"Smart IR":[{"infraredLevel":"setInfraredLevel"}]},{"Sous Vide":[{"switch":"off-on"},{"temperature":""}]},{"Curtains":[{"switch":"off-on"}]},{"Plant Grower":[{"switch":"off-on"}]},{"Airer":[{"switch":"off-on"}]},{"Scene Switch":[{"switch":"off-on"},{"button-numberOfButtons":""},{"color-hue-saturation":"setColor-setHue-setSaturation"},{"colorValue":"setColorValue"},{"colorMode":""},{"colorTemperature":"setColorTemperature"}]},{"Lighting Remote":[{"switch":"off-on"},{"button-numberOfButtons":""},{"color-hue-saturation":"setColor-setHue-setSaturation"},{"colorValue":"setColorValue"},{"colorMode":""},{"colorTemperature":"setColorTemperature"}]},{"Car Automation":[{"presence":""},{"switch":"off-on"}]},{"Door Sensor":[{"door":"close-open"},{"contact":""},{"lqi-rssi":""}]},{"Illuminance Sensor":[{"energy":""},{"level":"setLevel"},{"switch":"off-on"},{"":"configure"},{"":""},{"":""}]},{"Step Sensor":[{"goal-steps":""}]},{"Filter":[{"filterStatus":""}]},{"AudioPlayer":[{"mute":"mute-setMute-unmute"},{"volume":"setVolume-volumeDown-volumeUp"}]},{"GeoLocation":[{"accuracy-altitudeAccuracy-heading-lastUpdateTime-latitude-longitude-method-speed":""}]},{"PH Sensor":[{"pH":""}]},{"Smart Assistant":[{"switch":"off-on"},{"mute":"mute-setMute-unmute"},{"":"playTrack-playTrackAndRestore-playTrackAndResume"},{"audioTrackData":""},{"volume":"setVolume-volumeDown-volumeUp"},{"level-mute-status-trackData-trackDescription":"mute-nextTrack-pause-play-playTrack-previousTrack-restoreTrack-resumeTrack-setLevel-setTrack-stop-unmute"}]}]';
	var container = this.questionContainer;
	var all_iot = answer.split(",");
		//The array of Qbuilder "TR" objects
	var wholeArray = [];
	var j = 1;
	var obj1 = JSON.parse(txt1);

  var dict = {};
	console.log("Number of devices", all_iot.length);
    for(var index = 0; index < all_iot.length; index++) {
			for (var m = 0; m <obj1.length; m++){
        var fromTxt = JSON.stringify(Object.keys(obj1[m])[0]).trim().replace(/\"/g, '').replace(/' '/g, '');
        var selected_device = all_iot[index].replace(/\s/g, '');
        if(selected_device == fromTxt) {
          console.log("What is the devices ", all_iot[index]);
          var output =JSON.stringify(Object.values(obj1[m])[0]).trim().replace(/\"/g, '');
          dict[all_iot[index]] = output.replace(/-/g, ',');
			break;
        }
      }
  }
  console.log("dictionary:");
  console.log(dict);
	var table = document.getElementById("table_container");   
  var td_array=[];
  var tr_array=[];

	for(var index = 0; index < all_iot.length; index++) {

    var capability = dict[all_iot[index]];
    // Cheating a little bit by putting the capability as the id in order for dynamically exectue the onclick function
    var td = QBuilder('td',{class:'LabelContainer LabelContatiner', style:"padding-right:5px; padding-bottom:5px;", id:capability, onclick:"document.getElementById('capa').innerHTML = this.id"});
    var span = QBuilder('span',{class:'LabelWrapper'});
    var label = QBuilder('label',{class:'SingleAnswer', style:"width:120px; height:100px;"});
    var device_name = QBuilder('span',{ id:'t'+(index+1)},all_iot[index]);

    label.appendChild(device_name);
    span.appendChild(label);
    td.appendChild(span);
    td_array.push(td);

    // Adding another row once it reached to 7 devices
    if((index+1)%7 == 0){
      var new_tr = QBuilder('tr',{},td_array);
      td_array=[];
      tr_array.push(new_tr);
    }
	}
    var rest_tr = QBuilder('tr',{},td_array);
    tr_array.push(rest_tr);	
    var tbody = QBuilder('tbody',{},tr_array);	
    table.appendChild(tbody);

});

Qualtrics.SurveyEngine.addOnReady(function()
{
	/*Place your JavaScript here to run when the page is fully displayed*/

});

Qualtrics.SurveyEngine.addOnUnload(function()
{
	/*Place your JavaScript here to run when the page is unloaded*/

});
</script>
